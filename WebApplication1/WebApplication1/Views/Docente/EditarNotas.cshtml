@model WebApplication1.Models.EditarNotasViewModel

@{
    ViewData["Title"] = "Editar notas";
}

<main class="panel-wrapper">
    <section class="panel-card">
        <header>
            <h1 class="panel-title">Editar notas del alumno</h1>
            <p class="panel-subtitle">
                Modifica las notas de cada materia y guarda los cambios.
            </p>
        </header>

        <div class="panel-actions">
            <a asp-controller="Docente"
               asp-action="Alumnos"
               class="panel-btn panel-btn-outline">
                ← Volver al listado de alumnos
            </a>
        </div>

        <div style="margin-bottom: 20px;">
            <p><strong>Alumno:</strong> @Model.NombreCompleto</p>
            <p><strong>Carne:</strong> @Model.Carne</p>
            <p><strong>Especialidad:</strong> @Model.Especialidad</p>
            <p><strong>Grado / Sección:</strong> @Model.GradoSeccion</p>
        </div>

        <form asp-action="EditarNotas" method="post">
            @Html.AntiForgeryToken()

            <!-- MUY IMPORTANTE: enviar el AlumnoId -->
            <input asp-for="AlumnoId" type="hidden" />

            <table class="panel-table">
                <thead>
                    <tr>
                        <th>Materia</th>
                        <th>Parcial 1</th>
                        <th>Parcial 2</th>
                        <th>Nota final</th>
                    </tr>
                </thead>
                <tbody>
                    @for (int i = 0; i < Model.Notas.Count; i++)
                    {
                        <tr>
                            <!-- NotaId oculto para cada fila -->
                            <input asp-for="Notas[i].NotaId" type="hidden" />

                            <td>
                                @Model.Notas[i].Materia
                                <input asp-for="Notas[i].Materia" type="hidden" />
                            </td>
                            <td>
                                <input asp-for="Notas[i].Parcial1" class="form-control" />
                                <span asp-validation-for="Notas[i].Parcial1" class="text-danger"></span>
                            </td>
                            <td>
                                <input asp-for="Notas[i].Parcial2" class="form-control" />
                                <span asp-validation-for="Notas[i].Parcial2" class="text-danger"></span>
                            </td>
                            <td>
                                <input asp-for="Notas[i].NotaFinal" class="form-control" />
                                <span asp-validation-for="Notas[i].NotaFinal" class="text-danger"></span>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>

            <button type="submit" class="panel-btn panel-btn-primary" style="margin-top:20px;">
                Guardar cambios
            </button>
        </form>
    </section>
</main>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}
